<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>GPS Marker with My Photo</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v3.14.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v3.14.0/mapbox-gl.js"></script>
<style>
body { margin: 0; padding: 0; }
#map { position: absolute; top: 0; bottom: 0; width: 100%; }
.marker {
    display: block;
    border: 3px solid white;
    border-radius: 50%;
    background-size: cover;
    background-position: center;
    width: 60px;
    height: 60px;
}
</style>
</head>
<body>
<div id="map"></div>
<script>
mapboxgl.accessToken = "pk.eyJ1IjoiaG9vbmNvbSIsImEiOiJjbWNjM3R4enUwM3pnMmlxMWJvZTVrMWIzIn0.h_-BNK4FuriEfFWXvE1pmw";

// 지도 초기화
const map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/standard',
    center: [127.0, 37.5], // 초기 좌표 (한국 중심 근처)
    zoom: 15
});

// 마커 DOM 요소 생성 (사용자 사진)
const el = document.createElement('div');
el.className = 'marker';
// 여기에 본인 사진 URL 넣기 (로컬 경로 가능)
el.style.backgroundImage = 'url("https://example.com/myphoto.jpg")';

const marker = new mapboxgl.Marker(el).setLngLat([127.0, 37.5]).addTo(map);

// GPS 위치 업데이트 함수
function updatePosition(position) {
    const lon = position.coords.longitude;
    const lat = position.coords.latitude;

    // 기존 마커 제거 (존재하면)
    if (marker) marker.remove();

    // 새로운 마커 생성
    const marker = new mapboxgl.Marker({
        color: '#FF0000', // 빨간색으로 변경
        scale: 1.5, // 크기 조절
    })
    .setLngLat([lon, lat])
    .addTo(map);
}

// 에러 처리
function handleError(err) {
    console.error("위치 정보를 가져올 수 없습니다.", err);
}

// 실시간 위치 추적 시작
if ("geolocation" in navigator) {
    navigator.geolocation.watchPosition(updatePosition, handleError, {
        enableHighAccuracy: true,
        maximumAge: 0
    });
} else {
    alert("이 브라우저는 GPS를 지원하지 않습니다.");
}
</script>
</body>
</html>
