<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<title>GPS + RTIRL 오버레이 지도</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body{margin:0;font-family:sans-serif;background:#f5f5f5;}
  #container{max-width:400px;margin:2rem auto;text-align:center;}
  button{
    padding:.8rem 1.6rem;
    font-size:1rem;
    background:#0077ff;color:white;border:none;cursor:pointer;
    border-radius:4px;
  }
  button:hover{background:#005bbb;}
</style>
</head>
<body>

<div id="container">
  <h2>GPS 위치를 지도에 표시하기</h2>
  <p>아래 버튼을 눌러 현재 위치를 가져와 Mapbox 오버레이를 띄워 보세요.</p>
  <button id="startBtn">시작</button>
</div>

<script>
/* ---------- 1. 버튼 클릭 시 실행 ---------- */
document.getElementById('startBtn').addEventListener('click', () => {
    // ① 현재 위치 요청
    if (!navigator.geolocation) {
        alert('Geolocation API를 지원하지 않는 브라우저입니다.');
        return;
    }

    navigator.geolocation.getCurrentPosition(
        (pos) => handleSuccess(pos),
        (err) => handleError(err),
        { enableHighAccuracy: true, timeout: 10000 }
    );
});

/* ---------- 2. 성공 콜백 ---------- */
function handleSuccess(position){
    const { latitude, longitude } = position.coords;

    // ② 오버레이 URL 생성
    const baseUrl = 'https://overlays.rtirl.com/mapbox.html';
    const params = new URLSearchParams({
        key:          'zeoeyze9htbyx455',                       // RTIRL Key
        access_token: 'pk.eyJ1Ijoia2V2bW8zMTQiLCJhIjoiY2w0MW1qaTh3MG80dzNjcXRndmJ0a2JieiJ9.Y_xABmAqvD-qZeed8MabxQ',
        style:        'mapbox/streets-v11',
        zoom:         15,                      // 원하는 줌 레벨
        lang:         'ko',
        attribution:  0,
        indicatorStyle:'eyJoZWlnaHQiOjEyLCJ3aWR0aCI6MTIsImJvcmRlclJhZGl1cyI6NTAsImJhY2tncm91bmRDb2xvciI6ImN5YW4ifQ%3D%3D',
        // 현재 위치를 중심으로 지정
        center: `${longitude},${latitude}`
    });

    const url = `${baseUrl}?${params.toString()}`;

    // ③ 새 창(또는 탭) 열기
    window.open(url, '_blank', 'noopener,noreferrer,width=800,height=600');
}

/* ---------- 3. 실패 콜백 ---------- */
function handleError(error){
    console.error('GPS 오류:', error);
    alert(`위치를 가져오지 못했습니다: ${error.message}`);
}
</script>
</body>
</html>
